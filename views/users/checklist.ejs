<% layout('/layouts/boilerplate') %>
    <div class="container my-5">
        <div class="row">
            <div class="col-4 row">
                <div class="img img-thumbnail">
                    <img src="/utils/assests/download.jpeg" alt="pfp">
                </div>
                <div class="name"><%= user.username %></div>
            </div>
            <div class="offset-1 col-7">
                <% for (book of user.checkList){ %>
                <div class="card mb-3">
                    <div class="row">
                        <div class="col-md-4 p-4">
                            <% if (book.bookchecked.images) {checkedBook = book.bookchecked %>
                                <img src="<%= checkedBook.images[0].url %>" alt="" class="img-fluid" width="300px">
                            <% } else { %>
                                <img src="https://res.cloudinary.com/dqeaomlck/image/upload/v1719638738/Furniture/photo-1567016432779-094069958ea5_hzfaa0.avif" alt="" class="img-fluid" width="100%" height="auto">
                            <% } %>
                        </div>
                        <div class="col-md-8 p-4">
                            <span class="d-flex justify-content-between mb-2">
                                <h5 class="card-title mt-2"><%= checkedBook.title %></h5>
                            </span>
                            <span class="d-flex justify-content-between mb-2">
                                <small class="text-muted"><%= checkedBook.author %> | Published: <%= new Date(checkedBook.publishDate).getFullYear() %></small>
                            </span>
                           
                            <p class="card-text book-desc"><%= checkedBook.description %></p>
                        <script>
                            document.addEventListener("DOMContentLoaded", function() {
                                var elements = document.querySelectorAll(".book-desc");
                                elements.forEach(function(element) {
                                    var text = element.textContent;
                                    if (text.length > 150) {
                                        var truncated = text.substring(0, 150) + "...";
                                        element.textContent = truncated;
                                    }
                                });
                            });
                        </script>
                        <p class="card-text book-desc mt-2"><strong>Start Date: <%= book.startDate.getDate() %>/<%= book.startDate.getMonth()+1%>/<%= book.startDate.getFullYear() %></strong></p>
                        <p class="card-text book-desc"><strong>Borrowed for: <%= book.numberOfDays %> Days</strong></p>
                            
                        </div>
                    </div>
                    <a href="/books/<%= checkedBook._id %>" class="stretched-link"></a>
                </div>
                <% } %>
            </div>
        </div>
    </div>
</body>
</html>